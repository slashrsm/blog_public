<!DOCTYPE html>
<html dir="ltr" lang="en" prefix="content: https://purl.org/rss/1.0/modules/content/  dc: https://purl.org/dc/terms/  foaf: https://xmlns.com/foaf/0.1/  og:
https://ogp.me/ns#  rdfs: https://www.w3.org/2000/01/rdf-schema#  schema: https://schema.org/  sioc: https://rdfs.org/sioc/ns#  sioct:
https://rdfs.org/sioc/types#  skos: https://www.w3.org/2004/02/skos/core#  xsd: https://www.w3.org/2001/XMLSchema# ">
 <!-- Added by HTTrack -->
 <meta content="text/html;charset=utf-8" http-equiv="content-type"/>
 <!-- /Added by HTTrack -->
 <head>
  <meta charset="utf-8"/>
  <meta content="I did a lot of research, talking to community people and thinking about my GSoC project. More detailed features list has been created as a
result of that. I encourage you to check it out and propose some improvements and comments to it." name="description"/>
  <meta content="Drupal 9 (https://www.drupal.org)" name="Generator"/>
  <meta content="width" name="MobileOptimized"/>
  <meta content="true" name="HandheldFriendly"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <link href="../themes/custom/janezurevc_name/favicon/index.ico" rel="icon" type="image/vnd.microsoft.icon"/>
  <link href="/index.html" rel="canonical"/>
  <link href="/index.html" rel="shortlink"/>
  <title>
   Derivates API: Feature list | Janez Urevc
  </title>
  <link href="../core/modules/system/css/components/align.module/index.css?s16r9a" media="all" rel="stylesheet"/>
  <link href="../core/modules/system/css/components/fieldgroup.module/index.css?s16r9a" media="all" rel="stylesheet"/>
  <link href="../core/modules/system/css/components/container-inline.module/index.css?s16r9a" media="all" rel="stylesheet"/>
  <link href="../core/modules/system/css/components/clearfix.module/index.css?s16r9a" media="all" rel="stylesheet"/>
  <link href="../core/modules/system/css/components/details.module/index.css?s16r9a" media="all" rel="stylesheet"/>
  <link href="../core/modules/system/css/components/hidden.module/index.css?s16r9a" media="all" rel="stylesheet"/>
  <link href="../core/modules/system/css/components/item-list.module/index.css?s16r9a" media="all" rel="stylesheet"/>
  <link href="../core/modules/system/css/components/js.module/index.css?s16r9a" media="all" rel="stylesheet"/>
  <link href="../core/modules/system/css/components/nowrap.module/index.css?s16r9a" media="all" rel="stylesheet"/>
  <link href="../core/modules/system/css/components/position-container.module/index.css?s16r9a" media="all" rel="stylesheet"/>
  <link href="../core/modules/system/css/components/progress.module/index.css?s16r9a" media="all" rel="stylesheet"/>
  <link href="../core/modules/system/css/components/reset-appearance.module/index.css?s16r9a" media="all" rel="stylesheet"/>
  <link href="../core/modules/system/css/components/resize.module/index.css?s16r9a" media="all" rel="stylesheet"/>
  <link href="../core/modules/system/css/components/sticky-header.module/index.css?s16r9a" media="all" rel="stylesheet"/>
  <link href="../core/modules/system/css/components/system-status-counter/index.css?s16r9a" media="all" rel="stylesheet"/>
  <link href="../core/modules/system/css/components/system-status-report-counters/index.css?s16r9a" media="all" rel="stylesheet"/>
  <link href="../core/modules/system/css/components/system-status-report-general-info/index.css?s16r9a" media="all" rel="stylesheet"/>
  <link href="../core/modules/system/css/components/tablesort.module/index.css?s16r9a" media="all" rel="stylesheet"/>
  <link href="../core/modules/system/css/components/tree-child.module/index.css?s16r9a" media="all" rel="stylesheet"/>
  <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.css" integrity="sha256-0XAFLBbK7DgQ8t7mRWU5BF2OMm9tjtfH945Z7TTeNIo=" media="all" rel="stylesheet"/>
  <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@unicorn-fail/drupal-bootstrap-styles@0.0.2/dist/3.4.0/8.x-3.x/drupal-bootstrap.css" integrity="sha512-j4mdyNbQqqp+6Q/HtootpbGoc2ZX0C/ktbXnauPFEz7A457PB6le79qasOBVcrSrOBtGAm0aVU2SOKFzBl6RhA==" media="all" rel="stylesheet"/>
  <link href="../themes/custom/bootstrap_clean_blog/css/clean-blog/index.css?s16r9a" media="all" rel="stylesheet"/>
  <link href="../themes/custom/bootstrap_clean_blog/css/theme/index.css?s16r9a" media="all" rel="stylesheet"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" media="all" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" media="all" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" media="all" rel="stylesheet"/>
  <link href="../themes/custom/janezurevc_name/theme/index.css?s16r9a" media="all" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/styles/androidstudio.min.css" media="all" rel="stylesheet"/>
 </head>
 <body class="path-node node--type-article">
  <a class="visually-hidden focusable skip-link" href="#main-content">
   Skip to main content
  </a>
  <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas="">
   <nav class="navbar navbar-default">
    <div class="container-fluid">
     <!-- Brand and toggle get grouped for better mobile display -->
     <div class="navbar-header page-scroll">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
       <span class="sr-only">
        Toggle navigation
       </span>
       <span class="icon-bar">
       </span>
       <span class="icon-bar">
       </span>
       <span class="icon-bar">
       </span>
      </button>
      <a class="navbar-brand" href="/" title="Home">
       Janez Urevc
      </a>
     </div>
     <!-- Collect the nav links, forms, and other content for toggling -->
     <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <nav aria-labelledby="block-mainnavigation-menu" id="block-mainnavigation" role="navigation">
       <h2 class="sr-only" id="block-mainnavigation-menu">
        Main navigation
       </h2>
       <ul class="nav navbar-nav navbar-right">
        <li>
         <a data-drupal-link-system-path="node/2" href="/about.html">
          About
         </a>
        </li>
        <li>
         <a data-drupal-link-system-path="node/116" href="/get-in-touch.html">
          Get in touch
         </a>
        </li>
       </ul>
      </nav>
     </div>
     <!-- /.navbar-collapse -->
    </div>
   </nav>
   <!-- Page Header -->
   <!-- Set your background image for this header on the line below. -->
   <header class="intro-header" style="background-image: url('../themes/custom/janezurevc_name/images/default_bg/index.jpg')">
    <div class="container">
     <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
       <div class="post-heading">
        <h1>
         Derivates API: Feature list
        </h1>
       </div>
      </div>
     </div>
    </div>
   </header>
   <!-- Post Content -->
   <article>
    <div class="container">
     <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
       <a id="main-content">
       </a>
       <div class="region region-content">
        <div class="hidden" data-drupal-messages-fallback="">
        </div>
        <article about="/derivates-api-feature-list" role="article">
         <div class="post-meta submitted">
          <article about="/users/slashrsm" typeof="schema:Person">
          </article>
          <div class="post-date">
           <span>
            Mon, 30.05.2011
           </span>
          </div>
         </div>
         <div class="content">
          <div class="field field--name-body field--type-text-with-summary field--label-hidden field--item">
           <p>
            I did a lot of research, talking to community people and thinking about my GSoC project. More detailed features list has been created as a result
of that. I encourage you to check it out and propose some improvements and comments to it.
           </p>
           <h2>
            Basic features
           </h2>
           <h3>
            Ability to handle derivates as a managed or unmanaged file
           </h3>
           <p>
            The main difference between this two approaches is in a fact, that Drupal knows about existence of managed files, but does not about unmanaged
files. Managed files have it's own entry in&nbsp;
            <em>
             file_managed
            </em>
            DB table, while unmanaged files exist only in&nbsp;
            <em>
             files/
            </em>
            folder. Derivates API should implicitly or explicitly know also about unmanaged files.&nbsp;
           </p>
           <p>
            Managed files are autonomous file entities, but we must preserve reference to the original. This concept could be similar to node translation in
i18n, where there are references to original node from every translation.&nbsp;
            <strong>
             <em>
              QUESTION:
             </em>
            </strong>
            <em>
             Do we allow derivates of derivates? There should be some kind of mechanism to prevent "infinite loops" if yes.
            </em>
           </p>
           <p>
            <em>
             Examples:
            </em>
           </p>
           <ul>
            <li>
             video thumbnail: unmanaged
            </li>
            <li>
             low bitrate version of a podcast: unmanaged
            </li>
            <li>
             video podcast in different formats: unmanaged
            </li>
            <li>
             derivates that live in different streams: managed
            </li>
            <li>
             free sample video of a full version (accessible only to registered users): managed
            </li>
           </ul>
           <h3>
            Drupal must know about the derivate
           </h3>
           <p>
            Drupal must have information about existence of a derivate. This is quite trivial when dealing with managed, but can be tricky if we think about
unmanaged derivates. It would be cool, if there would be a mechanism for locating unmanaged files in an implicit way (similar to Image styles, where we define
a location of image with style name). We do not need any DB information about this files (i.e.: internal file management), if it could be done this way.
           </p>
           <h3 style="margin-top: 1em; margin-right: 0px; margin-bottom: 1em; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px;
padding-left: 0px; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color:
initial; vertical-align: baseline; ">
            Include an option to delete all derivates, when original is deleted
           </h3>
           <p>
            There will be a request to delete all derivates, if we delete their original. Since this is not always the case, it should be optional.&nbsp;
            <strong>
             <em>
              QUESTION:
             </em>
            </strong>
            &nbsp;
            <em>
             How do we delete unmanaged derivates, if there is no info about them in DB?
            </em>
           </p>
           <h3>
            Include an option to delete original, when derivates are created
           </h3>
           <p>
            Sometimes we do not need original anymore, when derivate was created. One of derivates should be proclaimed as original when this happens.
           </p>
           <h2>
            Backend engines framework
           </h2>
           <h3>
            Backends must know which files they support
           </h3>
           <p>
            There is probably no engine, that could possibly support all different file types, streams and file extensions. As engines will evidently support
only a smaller or bigger subset of files, we need a mechanism to allow them to tell us that. File type can be defined using one or more of this four parameters:
           </p>
           <ul>
            <li>
             file type
             <em>
              (image, video, audio, other, ...)
             </em>
             ,
            </li>
            <li>
             file stream
             <em>
              (public://, private://, youtube://, ...)
             </em>
             ,
            </li>
            <li>
             mime type
             <em>
              (image/jpg, image/png, ...)
             </em>
             ,
            </li>
            <li>
             file extension
             <em>
              (.avi, .mp4, .pdf, ...)
             </em>
             .
            </li>
           </ul>
           <p>
            Each engine will be asked to provide a set of rules, that will define a subset of files, that is supported by this engine. Rules will be connected
with conjunction (i.e. all rules must pass).
            <em>
             <strong>
              QUESTION:
             </strong>
             Do we need to support disjunction?
            </em>
           </p>
           <p>
            <strong>
             Example 1:&nbsp;
            </strong>
           </p>
           <ul>
            <li>
             type: video
            </li>
           </ul>
           <p>
            <strong>
             Example 2:
            </strong>
           </p>
           <ul>
            <li>
             type: video
            </li>
            <li>
             stream: youtube://
            </li>
           </ul>
           <p>
            <strong>
             Example 3:
            </strong>
           </p>
           <ul>
            <li>
             type: audio
            </li>
            <li>
             mime: audio/mp3, audio/ogg
            </li>
           </ul>
           <h3>
            Try to preserve metadata while transcoding
           </h3>
           <p>
            There are two types of metadata:
           </p>
           <ol>
            <li>
             <strong>
              Metadata stored in file itself (Ex.: EXIF, ID3, ...)
             </strong>
             : preservation of this metadata must be handeled by engines.&nbsp;
            </li>
            <li>
             <strong>
              Metadata stored in file entity fields
             </strong>
             : we should support copying of fields from original to derivate, but this must be optional. We should also support custom mapping of fields, since
it will not be always an 1:1 projection. As derivate can generally be a different file type, also fields in original and derivate will not always be the same.
            </li>
           </ol>
           <h3>
            Status of conversion must be accessible
           </h3>
           <p>
            Engine must be able to inform us about status of conversion. This information can be used as a feedback to the content creator or as an argument,
used to modify content's display (ex.: "This video is being trans coded and will be accessible in N minutes and M seconds." - Vimeo uses something similar for
videos that are being transcoded.). Display itself is not a job of this module. We just need to provide that information. A set of possible statuses must be
defined in advance, and could look similar to this:
           </p>
           <ul>
            <li>
             scheduled,
            </li>
            <li>
             running,&nbsp;
            </li>
            <li>
             done,
            </li>
            <li>
             timed out,
            </li>
            <li>
             unable to run,
            </li>
            <li>
             error (terminated).
            </li>
           </ul>
           <p>
            Transition between this states could also trigger hooks.
           </p>
           <h3>
            Transcoding scheduling (with rules or on demand)
           </h3>
           <p>
            There should exist some sets of rules, to define the actual start time of a conversion/transcode. This should be the job of API itself, since
engines does not have a lot in common with this feature. API should just run conversion process on a engine side, when there is a right time to do that. There
are three different options:
           </p>
           <ol>
            <li>
             <strong>
              Immediate run
             </strong>
             <strong>
              :
             </strong>
             asset is transcoded immediately after it becomes available to Drupal. Suitable for: video thumbnails, transcoding of small video files, triggering
transcodes on a 3rd party service, ...
            </li>
            <li>
             <strong>
              Scheduled run:
             </strong>
             some transcodes should be run at a later time (when there are more CPU resources available, at a certain time, ...). There should exist some kind
of a mechanism for definition of this rules. Rules should probably be time-based (run at 3:00 AM) and non time based (run when system load does not exceed 0.5
for 5 minutes). Suitable for: transcoding of big/high quality video assets.
            </li>
            <li>
             <strong>
              On demand run:
             </strong>
             asset, that was already available to Drupal, is transcoded on demand. This approach is similar to Image styles/Imagecache principles, since actual
conversion happens upon request. Request can come from the outside world (site visitor requests a .pdf version of a document, saved in .odt) or from the inside
(site editor/webmaster) triggers that conversion manually, since he wants to publish asset in another format.&nbsp;
            </li>
           </ol>
           <h3>
            Engine-specific configuration
           </h3>
           <p>
            Each engine should have ability to introduce it's own set of configuration parameters. This configuration should be accessible in a central
configuration form, but used only by an engine.&nbsp;
           </p>
           <h2>
            Other features
           </h2>
           <h3>
            Ability to export configurations to a feature
           </h3>
           <p>
            It would be great to have ability to export derivates configurations to a feature. This would allow us to simply create pre-defined configurations
for most common derivates. When I speak about configuration, I do not think about backend engine. I think about a set of parameters, that define a unique group
of derivates. Those parameters are:
           </p>
           <ul>
            <li>
             type of files, that this configuration applies to,
            </li>
            <li>
             managed/unmanaged files,&nbsp;
            </li>
            <li>
             backend engine to be used,&nbsp;
            </li>
            <li>
             metadata mapping,
            </li>
            <li>
             scheduling configuration,&nbsp;
            </li>
            <li>
             derivate specific configuration (deletion policy, ...),
            </li>
            <li>
             engine specific configuration,
            </li>
            <li>
             ...
            </li>
           </ul>
           <h3>
            Views support
           </h3>
           <p>
            Derivates should be view-able with views.&nbsp;
           </p>
           <h3>
            UPnP AV media servers support
           </h3>
           <p>
            There was a request to support UPnP AV media servers. This part should be handled by backend engines and stream wrappers and should fit in this
API, if designed well.
           </p>
           <p>
            Resources:
           </p>
           <ul>
            <li>
             <a href="https://en.wikipedia.org/wiki/Comparison_of_UPnP_AV_media_servers">
              https://en.wikipedia.org/wiki/Comparison_of_UPnP_AV_media_servers
             </a>
            </li>
            <li>
             <a href="https://en.wikipedia.org/wiki/UPnP_AV_media_server">
              https://en.wikipedia.org/wiki/UPnP_AV_media_server
             </a>
            </li>
           </ul>
           <h2>
            Other Questions:
           </h2>
           <ul>
            <li>
             Do we define a concept of "derivate type"? Where and how can we use that? How and who can define a new derivate type?
            </li>
            <li>
             Do we define a concept of "derivate sets"? Set is a group of derivate configurations. Some of parameters seem to be naturally more suitable to
derivate sets than derivates itself. Example:
             <ul>
              <li>
               <strong>
                Derivate set:
               </strong>
               &nbsp;Video podcast
              </li>
              <li>
               <strong>
                Derivate configurations:
               </strong>
               h264/720p/2000kbps, h264/480p/800kbps, xvid/480p/1500kbps, ...
              </li>
              <li>
               <strong>
                Rules that apply to sets:
               </strong>
               deletion policy (what happens, when original is deleted), conversion scheduling, metadata mapping, ...
              </li>
              <li>
               <strong>
                Rules that apply to derivate:
               </strong>
               engine to be used, engine-specific configuration, managed/unmanaged, derivate stream, ...
              </li>
             </ul>
            </li>
           </ul>
          </div>
          <div class="field field--name-field-tags field--type-entity-reference field--label-inline">
           <div class="field--label">
            Tags
           </div>
           <div class="field--items">
            <div class="field--item">
             <span>
              Summer of code 2011
             </span>
            </div>
            <div class="field--item">
             <span>
              Drupal
             </span>
            </div>
            <div class="field--item">
             <span>
              Open source
             </span>
            </div>
            <div class="field--item">
             <span>
              Media
             </span>
            </div>
            <div class="field--item">
             <span>
              Derivates API
             </span>
            </div>
           </div>
          </div>
         </div>
        </article>
       </div>
      </div>
     </div>
    </div>
   </article>
   <hr/>
   <!-- Footer -->
   <footer>
    <div class="container">
     <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
       <ul class="list-inline text-center">
        <li>
         <a href="https://github.com/slashrsm" target="_blank">
          <span class="fa-stack fa-lg">
           <i class="fa fa-circle fa-stack-2x">
           </i>
           <i class="fa-brands fa-github fa-stack-1x fa-inverse">
           </i>
          </span>
         </a>
        </li>
        <li>
         <a href="https://x.com/slashrsm" target="_blank">
          <span class="fa-stack fa-lg">
           <i class="fa fa-circle fa-stack-2x">
           </i>
           <i class="fa-brands fa-x-twitter fa-stack-1x fa-inverse">
           </i>
          </span>
         </a>
        </li>
        <li>
         <a href="https://si.linkedin.com/in/janezurevc" target="_blank">
          <span class="fa-stack fa-lg">
           <i class="fa fa-circle fa-stack-2x">
           </i>
           <i class="fa-brands fa-linkedin fa-stack-1x fa-inverse">
           </i>
          </span>
         </a>
        </li>
       </ul>
      </div>
     </div>
    </div>
   </footer>
  </div>
  <script data-drupal-selector="drupal-settings-json" type="application/json">
   {"path":{"baseUrl":"\/","scriptPath":null,"pathPrefix":"","currentPath":"node\/12","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDel
miter":"\u0003","suppressDeprecationErrors":true,"bootstrap":{"forms_has_error_value_toggle":1,"modal_animation":1,"modal_backdrop":"true","modal_focus_input":1
"modal_keyboard":1,"modal_select_text":1,"modal_show":1,"modal_size":"","popover_enabled":1,"popover_animation":1,"popover_auto_close":1,"popover_container":"bo
y","popover_content":"","popover_delay":"0","popover_html":0,"popover_placement":"right","popover_selector":"","popover_title":"","popover_trigger":"click","too
tip_enabled":1,"tooltip_animation":1,"tooltip_container":"body","tooltip_delay":"0","tooltip_html":0,"tooltip_placement":"auto
left","tooltip_selector":"","tooltip_trigger":"hover"},"disqusComments":"slashrsm","user":{"uid":0,"permissionsHash":"98faaa155a1d3d1c9a77b0c926183091b94fbfa1c6
1b6b55a329d0db91cf226"}}
  </script>
  <script src="../sites/default/files/js/js_AqmDmmXtxeaHVu3xcdG2zyaHEnlZalxy9J6xKDJ1uAI/index.js">
  </script>
  <!--[if lte IE 8]>
<script src="/sites/default/files/js/js_5RH3jC1tW_hjk-Nh0Q_ZFhpL-scB_L3h1PfGSh7kitQ.js"></script>
<![endif]-->
  <script crossorigin="anonymous" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js">
  </script>
  <script src="../sites/default/files/js/js_SBPs4Nz8s8sJ8Fu_02wEGLfwObvZDsPxZOtNkHQNtKc/index.js">
  </script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/highlight.min.js">
  </script>
  <script src="../sites/default/files/js/js_BpR0uWPRfXSLglxmI-MLiWRwWtbnsxDCDenNoWjaMiQ/index.js">
  </script>
 </body>
</html>
